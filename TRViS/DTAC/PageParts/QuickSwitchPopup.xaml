<?xml version="1.0" encoding="utf-8" ?>
<ContentView
	xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
	xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
	xmlns:local="clr-namespace:TRViS.DTAC.PageParts"
	xmlns:models="clr-namespace:TRViS.IO.Models;assembly=TRViS.IO.ILoader"
	xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"
	x:Class="TRViS.DTAC.QuickSwitchPopup">
	<Grid
		Padding="8">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
		</Grid.RowDefinitions>

		<!-- Tab Buttons -->
		<Grid
			Grid.Row="0"
			Margin="0,0,0,8">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="4"/>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition Width="4"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<local:TabButtonSmall
				x:Name="WorkGroupTabButton"
				Grid.Column="0"
				ButtonText="WorkGroup"/>

			<local:TabButtonSmall
				x:Name="WorkTabButton"
				Grid.Column="2"
				ButtonText="Work"/>

			<local:TabButtonSmall
				x:Name="TrainSearchTabButton"
				Grid.Column="4"
				ButtonText="Search"/>
		</Grid>

		<!-- Lists Container -->
		<Grid
			Grid.Row="1">
			<!-- WorkGroup List -->
			<Border
				x:Name="WorkGroupListContainer"
				Padding="4"
				StrokeThickness="0">
				<ListView
					x:Name="WorkGroupListView"
					SelectionMode="Single"
					SeparatorVisibility="Default"
					ios:ListView.SeparatorStyle="FullWidth"
					ItemSelected="WorkGroupListView_ItemSelected">
					<ListView.ItemTemplate>
						<DataTemplate
							x:DataType="models:WorkGroup">
							<TextCell
								Text="{Binding Name}"/>
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>
			</Border>

			<!-- Work List -->
			<Border
				x:Name="WorkListContainer"
				IsVisible="False"
				Padding="4"
				StrokeThickness="0">
				<ListView
					x:Name="WorkListView"
					SelectionMode="Single"
					SeparatorVisibility="Default"
					ios:ListView.SeparatorStyle="FullWidth"
					ItemSelected="WorkListView_ItemSelected">
					<ListView.ItemTemplate>
						<DataTemplate
							x:DataType="models:Work">
							<TextCell
								Text="{Binding Name}"/>
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>
			</Border>

			<!-- Train Search -->
			<Border
				x:Name="TrainSearchContainer"
				IsVisible="False"
				Padding="4"
				StrokeThickness="0">
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>

					<!-- Search Input -->
					<Grid
						Grid.Row="0"
						Margin="0,0,0,8">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="8"/>
							<ColumnDefinition Width="Auto"/>
							<ColumnDefinition Width="4"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>

						<Entry
							x:Name="TrainNumberEntry"
							Grid.Column="0"
							Placeholder="列番を入力"
							Keyboard="Numeric"
							ReturnType="Search"
							Completed="TrainNumberEntry_Completed"/>

						<Button
							x:Name="SearchButton"
							Grid.Column="2"
							Text="検索"
							Clicked="SearchButton_Clicked"/>

						<Button
							x:Name="CancelSearchButton"
							Grid.Column="4"
							Text="キャンセル"
							Clicked="CancelSearchButton_Clicked"/>
					</Grid>

					<!-- Return to Scheduled Train Button (hidden by default) -->
					<Button
						x:Name="ReturnToScheduledButton"
						Grid.Row="1"
						Text="所定列車に戻る"
						IsVisible="False"
						Margin="0,0,0,8"
						Clicked="ReturnToScheduledButton_Clicked"/>

					<!-- Search Results -->
					<ListView
						x:Name="SearchResultsListView"
						Grid.Row="2"
						SelectionMode="Single"
						SeparatorVisibility="Default"
						ios:ListView.SeparatorStyle="FullWidth"
						ItemSelected="SearchResultsListView_ItemSelected">
						<ListView.ItemTemplate>
							<DataTemplate>
								<TextCell Text="{Binding DisplayText}"/>
							</DataTemplate>
						</ListView.ItemTemplate>
					</ListView>
				</Grid>
			</Border>
		</Grid>
	</Grid>
</ContentView>
